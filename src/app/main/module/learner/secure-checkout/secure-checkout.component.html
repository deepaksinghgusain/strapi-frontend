<div class="modal-header">
    <h4 class="modal-title pull-left"> <img src="../../../../assets/params/images/banner/login-logo.svg" alt="logo">
    </h4>
    <button type="button" class="close close-modal pull-right" aria-label="Close" data-dismiss="modal"
        (click)="close()">
        <img src="../../../../assets/params/images/icons/btn-close.svg">
    </button>
</div>

<div class="modal-body modal-body-instructor">
    <div class="list-row">
        <div class="row">
            <div class="col-sm-12 col-md-12 col-lg-5">
                <div class="course-quick-view secure-quick-view">
                    <h2 class="mb-5 heading-lg">secure checkout</h2>

                    <p class="mb-5 paragraph text-uppercase font-barlow">Please enter participant details below.
                    </p>

                    <div class="secure-checkout-content">
                        <ul>
                            <li *ngFor="let cart of cartItems; let i = index">
                                <h3>{{i+1}}.&nbsp; {{ cart?.course?.title }}</h3>

                                <!-- <div class="form-row" *ngFor="let enroll of enrolls; let j = index"> -->
                                <div class="form-row" *ngFor="let enroll of cart.Enrolls; let j = index">
                                    <!-- <div *ngIf="j<cart.qtyArray.length-1" class="col-sm-12"> -->
                                    <div class="col-sm-12">
                                        <div class="row">
                                            <div class="col-sm-6 ">
                                                <span>{{j+1}})</span>
                                                <div class="input-group ">
                                                    <input autocomplete="off" type="text" [name]="'enroll_' + j"
                                                        [(ngModel)]="enroll.name" class="form-control form-control-sm"
                                                        placeholder="FIRST NAME"
                                                        (ngModelChange)="firstnamechange($event,'enroll_' + j, i)">
                                                </div>
                                                <div class="error-message-show"
                                                    *ngIf="errorText2 && 'enroll_' + j === name && i===i_index">! &nbsp;
                                                    {{firstnameMessage }} </div>
                                            </div>
                                            <div class="col-sm-6 ">
                                                <br>
                                                <div class="input-group ">
                                                    <input autocomplete="off" type="text" [name]="'enroll_' + j"
                                                        [(ngModel)]="enroll.lastname"
                                                        class="form-control form-control-sm" placeholder="LAST NAME"
                                                        (ngModelChange)="lastnamechange($event,'enroll_' + j, i)">
                                                </div>
                                                <div class="error-message-show"
                                                    *ngIf="errorText1 && 'enroll_' + j === name && i===i_index">! &nbsp;
                                                    {{lastnameMessage}} </div>

                                            </div>
                                            <div class="col-sm-6 ">
                                                <div class="input-group ">
                                                    <input autocomplete="off" type="text" [name]="'enroll_' + j"
                                                        [(ngModel)]="enroll.email" class="form-control form-control-sm"
                                                        placeholder="EMAIL"
                                                        (ngModelChange)="emailchange($event,'enroll_' + j, i)">
                                                </div>
                                                <div class="error-message-show"
                                                    *ngIf="errorText3 && 'enroll_' + j === name && i===i_index">! &nbsp;
                                                    {{emailMessage}} </div>
                                            </div>

                                            <div class="col-sm-6 ">
                                                <div class="input-group ">
                                                    <input autocomplete="off" type="text" [name]="'enroll_' + j"
                                                        [(ngModel)]="enroll.ptin" class="form-control form-control-sm"
                                                        placeholder="PTIN(IF APPLICABLE)"
                                                        (ngModelChange)="changed($event,'enroll_' + j, i)">
                                                </div>
                                                <!-- <small class="font-barlow1" *ngIf="!errorText || 'enroll_' + j === name && i===i_index">{{ptinInfo}}</small> -->
                                                <div class="error-message-show"
                                                    *ngIf="errorText && 'enroll_' + j === name && i===i_index">! &nbsp;
                                                    {{ptinMessage}} </div>
                                                <div class="error-message-show"
                                                    *ngIf="!errorText && 'enroll_' + j === name && i===i_index">
                                                    {{ptinMessage}} </div>
                                            </div>
                                        </div>
                                        <!--6-->
                                    </div>
                                </div>

                                <!--row-->
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="col-sm-12 col-md-12 col-lg-7">
                <div class="pt-5 course-quick-view-summary">
                    <h3 class="mb-4 heading-sm text-uppercase font-barlow color-blue">summary</h3>
                    <ul class="summary-list">
                        <li *ngFor="let cart of cartItems; let i = index">
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="view-summary-card">
                                        <div class="mb-4 event-course-image">
                                            <img src="{{ getImage(cart?.course) }}" class="img-fluid">
                                            <div *ngIf="cart?.course?.category =='Live'" class="event-tag-live">Live
                                                event</div>
                                            <div *ngIf="cart?.course?.category =='Recorded'" class="event-tag-live">
                                                Recorded event</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-sm-8">
                                    <div class="view-summary-content">
                                        <h3 class="text-uppercase font-barlow heading-xs ">{{ cart?.course.title }}</h3>
                                        <div class="mt-3 mb-2 time-info">
                                            <label *ngIf="cart?.course?.category !='Recorded'">{{
                                                cart?.course?.start_date | date: 'EEEE, MMMM d, y'}} </label>
                                            <span *ngIf="cart?.course?.category !='Recorded'">{{
                                                cart?.course?.start_date | date: 'h:mm a'}}
                                                {{ cart?.course.end_date != null ? '-': '' }}
                                                {{ cart?.course?.end_date | date: 'h:mm a'}}

                                            </span>
                                        </div>
                                        <div *ngIf="cart?.course?.category !='Recorded'" class="date-info">
                                            <span>
                                                <img (click)="addToCalendar(cart?.course)" alt=" add to calendar"
                                                    src="../../../../../assets/params/images/icons/date-picker.png"></span>+
                                            ADD TO MY CALENDAR
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="enroll-no font-barlow">
                                        <label>ENROLLMENTS: <span>{{ cart?.qty }}</span></label>
                                    </div>
                                </div>
                                <div class="col-sm-8">
                                    <div class="secure-payment-info font-barlow">
                                        <!-- <span>${{ cart?.qty * cart?.course?.price }}</span> -->
                                        <div
                                            *ngIf="(cart?.course?.discount || cart?.course?.discountedPrice || cart?.course?.discounted_price) >0; else price">
                                            
                                            {{ (cart?.qty * cart?.course?.discount | currency:'USD':'symbol') ||
                                            (cart?.qty * cart?.course?.discountedPrice | currency:'USD':'symbol') ||
                                            (cart?.qty * cart?.course?.discounted_price | currency:'USD':'symbol') }}
                                        </div>
                                        <ng-template #price>
                                            <span *ngIf="cart?.packageId != 0 && cart?.course?.price !=null "> {{ (cart?.qty * cart?.course?.price ) >=
                                                0 ? (cart?.qty * cart?.course?.price |
                                                currency:'USD':'symbol') : (cart?.course?.includedCoursePrice *
                                                cart?.qty) | currency:'USD':'symbol'}}</span>
                                                <span *ngIf="cart?.packageId != 0 && cart?.course?.price ==null "> {{  cart?.qty * cart?.course?.includedCoursePrice  | currency:'USD':'symbol' }}</span>
                                                
                                            <span *ngIf="cart?.courseId != 0"> {{cart?.qty * cart?.course?.price |
                                                currency:'USD':'symbol'}}</span>
                                        </ng-template>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </ul>

                    <div class="secure-payment-report">
                        <div class="row">
                            <div class="col-sm-4">

                            </div>
                            <div class="col-sm-8">
                                <div class="coupan-apply">
                                    <input [disabled]="couponRes" type="text" placeholder="COUPON CODE"
                                        [(ngModel)]="couponValue">
                                    <button type="button" [disabled]="couponRes" class="btn btn-apply"
                                        (click)=" disableCouponButton >0 && couponRes ?null : applyCoupon()">{{couponRes?'Applied':'Apply'}}</button>
                                    <br />
                                    <span *ngIf="couponRes">Coupon successfully applied</span>
                                    <span class="text-danger">{{couponErrMsg}}</span>
                                </div>
                                <div class="course-value">
                                    <table>
                                        <tbody>
                                            <tr>
                                                <td>Original price:</td>
                                                <td>{{ totalPrice | currency:'USD':'symbol'}}</td>
                                            </tr>

                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <td>TOTAL PRICE: </td>
                                                <td> {{ finalPrice | currency:'USD':'symbol' }}</td>
                                            </tr>
                                        </tfoot>
                                    </table>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" [checked]="agreeTerms" (change)="agreeTerms = !agreeTerms"
                                        class="form-check-input">
                                    <label class="form-check-label" for="rememberPassword">By placing this order, I
                                        acknowledge that I have read and agree to the <a target="_blank"
                                            routerLink="/payment-terms"> <u>purchase terms and
                                                conditions</u></a></label>
                                </div>
                                <div class="modal-footer-btn">
                                    <button (click)="checkout()" [disabled]="!agreeTerms"
                                        class="btn btn-primary w-100">purchase</button>
                                    <!-- <a href="" class="btn btn-primary w-100">purchase</a> -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>